h1. 7 Безопасность и Конфиденциальность

h2. 7.1 Требования 

**Безопасность, конфиденциальность и согласия**
Безопасность (возможность ограничить тех, кто смотрит персональные данные) и конфиденциальность (обязательство  других уважать персональные данные) главная проблема отношений пользователей к системам ЕМК. Общепринято что предоставленная информация (либо непосредственно, либо через обследования, либо через анализ образцов) доверяется пациентом медицинским специалистом в процессе медицинского случая должна быть передана или быть доступна с согласия пациента; проще говоря: __обмен данных должен контролироваться согласием пациента__. Более комплексные требования для некоторых пациентов позволяет разграничить доступ  __к частям__ его ЭМК, для примера, относительно открытые права доступа для большинства медицинских записей, но ограничен доступ к информации о сексуальном здоровье и психических заболеваний. 
Взаимосвязанность медицинской информации может этот затруднить. Для примера список назначенных медицинских препаратов зависит от условия скрыт ли диагноз, который нужен для предоставления безопасного лечения, и многие медицинские работники необходимо видеть невозможность текущих назначений(и аллергии), и это весьма проблематично даже для базового хода.

**Требования медицинских учреждений**
С другой стороны, клинические специалисты оказывая помощь, хотят быстрый доступ к относящимся к пациенту данным, и должны быть уверенны что то, что они видят на экране должно точно передавать 
уверен, что то, что они видят на экране точное это именно то что до них было внесено в систему о пациенте.  
Персоналу оказывающий уход иногда необходим экстренный доступ к медицинским записям (случаи не относящиеся к повседневному уходу); на такой доступ должно быть общее согласие, т.к. не известно когда он может понадобиться.

Исследователи в области здравоохранения часто хотят доступ к данным большого числа людей с целью оценки качества ухода и его улучшения (исследование состояния клиник) и для целей изучения. Обеспечение эффективной помощи и поддержки текущих медицинских исследований, следовательно, должны функционировать в системе с позволения пациента.

**Настройка контроля доступа**
В теории права доступа к информации должны легко настраиваться пациентом или клиническим специалистом. В некоторых случаях это может быть сделано прямым назначение, на пример пациент может указать своего постоянного врача общей практики. Потенциально могут быть сделаны исключения для такого способа, например если у пациента плохие личные отношения с прошлым доктором. Однако вскоре становиться трудно каждый раз определять конкретного человека который имеет доступ, особенно если человеку нужно обратиться в больницу, где много персонала и/или нет предварительно установленных связей. Появление системы электронного назначения и электронных аптек принесёт ещё больше медицинских и близких с медициной сотрудников в матрицу электронного здоровья, что делает систему индивидуального назначения прав невозможной. Более того, существует большая и постоянно растущая категория "очень мобильных" людей (военных, артистов, работников неправительственных организаций, международных бизнесменов, спортсменов... ) которые не могут предсказать даже страну в которой им может понадобиться помощь. В результате, необходимость указывать права доступа по наименованию или по роли неизбежно.

**Проблема ролей**
Одной из сложных задач для осуществления контроля доступа к медицинской информации является определение «ролей», т.е. статус пользователей медицинской записи при предоставленном доступе. Важно, чтобы роли были установлены заранее. Например, ярлыки "медсестра", "врач общей практики" и "психиатр" могут относительно легко присваивается конкретным лицам. Разные типы ярлыков могут иметь больший приоритет для различения между (для примера) главным лечащим врачем, других медицинских сотрудников(медицинских сестёр, сиделок) и вспомогательного персонала(например, патологоанатомов, рентгенологов). При взгляде на мир под призмой услуго-ориентированных медицинских услуг, профессиональных уровень медицинских специалистов является менее важным, чем личное отношение пациента к процессу его лечения.

Это не всегда ясно как люди могут в любой момент могут находятся в любой из этих категорий, или как эти термины могут быть определены в разным местах и странах. Реально, оценка категории ролей, такие как "ухаживающий персонал", в частности медсестра в отделении должны определяться в медицинской организации каждый день, а не в медицинской карте пациента. Решение о доступе к информации в медицинской карте должно зависеть от знаний поставщика услуг о своём персонале, который вовлечён в уход за пациентом.

Контроль доступа основанный на роли осложняется фактом временной замены по причине болезни  или отпуска, или роль изменяется в связи с нехваткой персонала. Кроме того, если у врача есть секретарь, то и для него требуется доступ и возможность обновления его секретной части (относящейся к лечению пациента) информации, т.е. доступ на самом высоком уровне нужно дать кому-то без медицинского образование или непосредственно связанного с помощью пациенты, даже если только в течение 10 минут. Любая ролевая система учитывет суровую реальность медицинской помощи в мире, а не исключительно теоретические принципы.

**Удобство использования**
Удобство использования механизмов безопасности и конфиденциальности является ключевым требованием к архитектуре медицинских записей. Некоторые элегантные решения точного контроля доступа разработанные экспертами по безопасности не пригодны для использования в связи с тем что занимают слишком много времени для изучения их пациентом или доктором, либо слишком много времени чтобы их выполнять, или же слишком сложны чтобы их возможно было использовать в программном обеспечении.

В следующих разделах описана поддержка требований медицинской карты к основам безопасности и конфиденциальности в openEHR.

h2. 7.2 Угрозы Безопасности и Конфиденциальности

Любая модель, такая как безопасность и конфиденциальность, поддерживаемая электронной историей болезни, должна основываться на понимании предполагаемых угроз. Не в даваясь в подробности, угрозы безопасности учтённые в openEHR включают в себя (здесь "неуместным" является все, на что не было или не будет согласия пациента):

* человеческие ошибки в идентификации пациентов, что приводит к неправильным объединение данных о состоянии здоровья одного пациента с другим. Неправильная идентификация может привести к тому, что данные одного пациента попадут в медицинскую карту другого пациента (что приводит к нарушении конфиденциальности и, возможно, клинических ошибок), или созданию новой карты, вместо записи в существующую (что приведёт к появлению двух и более неполных карт);
* несанкционированный доступ со стороны врачей или других работников здравоохранения (в том числе любой работник больницы) не участвующим в уходе за пациентов в данный момент;
* несанкционированный доступ других лиц, знающих пациента, например, членов семьи;
* несанкционированный доступ к медицинским данным корпораций или других организаций, напрмер, в цели страховой дискриминации;
* вредоносная кража или доступ к медицинским данным (например, знаменитостей или политикам) с целью получения прибыли или иных личных побуждений;
* общие угрозы целостности данных и их доступности, такие как вирусы, черви, атаки отказа в обслуживании;
* сбои в программном обеспечении (в результате ошибок, неправильной конфигурации, ошибки взаимодействия и т.д.) вызывающие искажение данных или неправильное отображение иди вычисления в результате критических проблем.

Главное при проектировании дизайн механизмов поддержки безопасности, конфиденциальности и целостности данных нужно иметь ввиду: вероятность того или иного метода несанкционированного доступа пропорционально ценности информации и обратно пропорционально стоимости доступа.
Перефразируя письмо в БАМ Росс Анедрсона[72] в безопасности клинических данный, для получения доступа, преступник попробует найти простейший, дешёвый и быстры способ, что в большинстве случаев будет подкуп или кража с взломом, чем технологии в стиле Джеймса Бонда. openEHR позволяет использовать эти принципы путём относительно простых механизмов, которые дёшевы в реализации, но делает злоупотребление довольно сложным, без ущерба для доступности. 

fn72. см. например, Ross Anderson - "Security in Clinical Information Systems" по адресу "http://www.cl.cam.ac.uk/users/rja14/policy11/policy11.html":http://www.cl.cam.ac.uk/users/rja14/policy11/policy11.html.

h2. 7.3 Решения Предоставленные openEHR

h3. 7.3.1 Обзор

Много из конкретных механизмов, касающихся безопасности можно найти в окружающих системах, а не в таких моделях как openEHR, в частности осуществляющие аутентификацию, контроль доступа и шифрование. Спецификация openEHR и реализация основных компонентов явно не определяет многие конкретные механизмы, так как существует вариативность требований для разных сторон - защищённая локальная сеть требует минимальную внутреннюю безопасность, в то время как веб-сервисы для доступа к медицинским записям, скорее всего, имеют совершенно другие требования.
OpenEHR поддерживает ключевые требования в состоянии, позволяющем создавать систему в соответствии существенно разным тербованиями и конфигурациями, но тем не менее реализовывая  основные принципы стандартным способом. Рисунок 21 иллюстрирует основные меры безопасности, прямо указанных в архитектуре openEHR. Они включают в себя разделение электронной карты/ демографии, а так же всесистемного контроля доступа к медицинской карте. На уровне версий объектов, проверок внесённых изменений (обязательный) имеются цифровых подписи и хэши. В следующих подразделах описываются эти функции более подробно.


!fig21.png(Рисунок 21)!

h3. 7.3.2 Политика безопасности

Само по себе, электронная медицинская карта в openEHR накладывает лишь минимальный профиль политики безопасности, который может рассматриваться в качестве необходимого, но, как правило, не достаточно для развертывания системы (т.е. другие аспекты будут по-прежнему должны быть реализованы в слоях, чья семантика не определены в openEHR) . Следующие принципы политики воплощаются в openEHR.

**Общие принципы**

- Нестираемости: = записи о состоянии здоровья не может быть удалена; логика удаления достигается путём маркировки данных таким образом, чтобы они выглядели удалёнными (реализовано в системе управления версиями).
- Аудиторский след := Все изменения, внесённые в ЭМК, в том числе в содержание объектов, а также статус ЭМК и объекты контроля доступа отслеживаются при помощи идентичности пользователя , отметки времени, причины изменений, по желанию цифровой подписью и соответствующей информации о версии; за одним исключением, где модификатор является пациент, в этом случае будет использован символьный идентификатор (известный как @PARTY_SELF@, в openEHR, см. следующий пункт).
- Анонимность := содержание медицинских записей отдельно от указания демографической информации. Это может быть настроено так, что кража ЭМК не даёт никаких прямых ключ к личности владельца пациента (косвенные подсказки, конечно, сложнее контролировать). Кража идентифицированной ЭМК включает в себя кражу данных из двух сервисов, или даже кражи из двух физических компьютеров, в зависимости от конфигурации развёртывания.

**Контроль доступа**
- Список доступа: = Главный принцип контроля доступа должен быть в "актуальности", как в плане идентификации пользователей (который оказывает помощь пациенту) и время (в течение текущего эпизода оказания медицинской помощи, а также для некоторого разумного, ограниченного времени после этого). Список контроля доступа могут быть определены для ЭМК с указанием как конкретных лиц и категорий, последние из которых могут быть типами ролей или отдельными группами сотрудников.
- Контроль доступа к настройкам доступа := __привратник__ контролирует доступ к параметрам контроля доступа ЭМК. Привратник устанавливается в момент создания ЭМК как один из тех, кто знает о идентичности в ЭМК, как правило, это в пациент психически взрослый, в противном случае родителя, опекуна, адвоката или другого ответственного лица. Привратник определяет, кто может вносить изменения в список управления доступом. Все изменения в списке аудита отслеживаются, как и для обычные данные (достигается за счёт обычного версионирования).
- Конфиденциальность := пациенты могут отмечать Композицию в ЭМК как одну из тех что имеет нескольких уровней секретности. Определение уровни конфиденциальности не привязаны к модели openEHR, а определяется стандартами или соглашений в рамках юрисдикции использования.
- Удобство использования := Общий принцип настройки управления доступа являются "разумные значения по умолчанию", которые работают на большей части информации в ЭМК, большую часть времени. Пациент может установить стандартные настройки для ЭМК, определяющие поведение системы контроля доступа для большинства вопросов доступа. Исключения из политики по умолчанию могут быть добавлены. Такой подход сводит к минимуму необходимость думать о безопасности каждого элемента в ЭМК индивидуально.

Другие принципы политики безопасности, которые должны быть реализованы даже в минимальных развёртываниях EHR, но напрямую не указанные в openEHR включают в себя следующие.  

- 
- Логирование доступа := доступ на чтение к приложению пользователями ЭМК должны быть записаны в журнал самой системой ЭМК. В настоящее время в openEHR не уточняется, модели таких журналов, но это может быть сделать в будущем. Исследования показали, что осознавание того что доступ пользователей записывается является сдерживающим фактором от несанкционированного доступа (особенно там, где другие элементы управления не реализованы). Есть некоторые сторонники того, что даже журналы чтения-доступа должна быть частью ЭМК, но в настоящее время openEHR не поддерживает такой подход.
- Отделение медицинских записей := когда данные пациента оказываются в ЭМК другого пациента, для определения того, кто получил доступ к этим данным и в первую очередь определить какие последующие клинические мышления (например, диагноз, медицинские назначения) были сделаны на основе неверной информацию, нужно смотреть данные о доступе из журнала ЭМК.
- Слияние записей := когда более чем одна ЭМК обнаружилась для одного и того же пациента, и эти данные должны быть объединены в одну карту, списки контроля доступа должны быть пересмотрены и объединены с пациентом и имеющих к нему отношение поставщиков услуг.
- Временное ограничение доступа := Должны быть реализованы механизмы, которые ограничивают время, в течение которого медицинских работники могут видеть карту пациента. Как правило, внешние границы определяются интервалом эпизода оказания медицинской помощи в учреждении, плюс некоторое дополнительное время для завершения лечения или амбулаторного лечения. Начало и конец эпизода отражаются в openEHR как экземпляры ADMIN_ENTRY класса, содержащие детализацию госпитализации и выписки.
- строгая однозначность := если цифровая подпись изменений в карте установлена как   обязательная, то система openEHR поддерживает строгую однозначность содержания. OpenEHR также поддерживается цифровая подпись отдельной информации (выгрузка из ЭМК); вместе с записью в журнал о Выгрузке объектов(Extracts), это может быть использовано, чтобы гарантировать однозначность передачи информация между системами (см. информацию, передаваемую между бекендом и фронтедом той же системы).
- Сертификация := a mechanism should be provided to allow a level of trust to be formally associated with user signing keys.

A key feature of the policy is that it must scale to distributed environments in which health record information is maintained at multiple provider sites visited by the patient.

As Anderson points out in the BMA study, policy elements are also needed for guarding against users gaining access to massive numbers of EHRs, and inferencing attacks. Currently these are outside the scope of openEHR, and realistically, of most EHR implementations of any kind today.

The following sections describe how openEHR supports the first list of policy objectives.

h3. 7.3.3 Integrity

**Versioning**
The most basic security-related feature of openEHR is its support for data integrity. This is mainly provided by the versioning model, specified in the @change_control@ package in the Common Information Model, and in the Extract Information Model. Change-set based versioning of all information in the EHR and demographic services constitutes a basic integrity measure for information, since no content is ever physically modified, only new versions are created. All logical changes and deletions as well as additions are therefore physically implemented as new Versions rather than changes to existing information items. Clearly the integrity of the information will depend on the quality of the implementation; however, the simplest possible implementations (1 Version = 1 copy) can provide very good safety due to being write-once systems.
The use of change-sets, known as Contributions in openEHR, provides a further unit of integrity corresponding to all items modified, created or deleted in a single unit of work by a user. 
The openEHR versioning model defines audit records for all changed items, which can be basic audits and/or any number of additional digitally signed attestations (e.g. by senior staff). This means that every write access of any kind to any part of an openEHR record is logged with the user identification, time, reason, and potentially other meta-data. Versioning is described in detail in section 8 on page 42.

**Digital Signature**
The possibility exists within an openEHR EHR to digitally sign each Version in a Versioned object (i.e. for each Version of any logical item, such as medications list, encounter note etc.). The signature is created as a private-key encryption (e.g. RSA-1) of a hash (e.g. MD5) of a canonical representation (such as in schema-based XML) of the Version being committed. A likely candidate for defining the signature and digest strings in openEHR is the openPGP message format (IETF RFC2440[1]), due to being an open specification and self-describing. The use of RFC2440 for the format does not imply the use of the PGP distributed certificate infrastructure, or indeed any certification infrastructure; openEHR is agnostic on this point. If no public key or equivalent infrastructure is available, the encryption step might be omitted, resulting in a digest only of the content. The signature is stored within the Version object, allowing it to be conveniently carried within EHR Extracts. The process is shown in FIGURE 22. 
The signing of data in a versioning system acts as an integrity check (the digest performs this function), an authentication measure (the signature performs this function), and also a non-repudiation measure. To guard against hacking of the versioned persistence layer itself, signatures can be forwarded to a trusted notarisation service. A fully secure system based on digital signing also requires certified public keys, which may or may not be available in any given environment. 
One of the benefits of digitally signing relatively small pieces of the EHR (single Versions) rather than the whole EHR or large sections of it is that the integrity of items is more immune to localisedrepository corruptions.

!fig22.png(FIGURE 22)!

fn1. IETF RFC 2440 - "http://www.ietf.org/internet-drafts/draft-ietf-openpgp-rfc2440bis-18.txt":http://www.ietf.org/internet-drafts/draft-ietf-openpgp-rfc2440bis-18.txt

h3. 7.3.4 Anonymity

As described above in section 6.1, one of the features of the openEHR EHR is a separation of EHR (clinical and administrative) information and demographic information. This mainly relates to references to the patient rather than to provider entities, since the latter are usually publicly known. A special kind of object known as @PARTY_SELF@ in openEHR is used to refer to the subject in the EHR. The only information contained in a @PARTY_SELF@ instance is an optional external reference. The openEHR EHR can be configured to provide 3 levels of separation by controlling whether and where this external identifier is actually set in @PARTY_SELF@ instances, as follows:

* Nowhere in the EHR (i.e. every @PARTY_SELF@ instance is a blank placeholder). This is the most secure approach, and means that the link between the EHR and the patient has to be done outside the EHR, by associating EHR.ehr_id and the subject identifier. This approach is more likely for more open environments.
* Once only in the EHR Status object (subject attribute), and nowhere else. This is also relatively secure, if the EHR Status object is protected in some way.
* In every instance of @PARTY_SELF@; this solution is reasonable in a secure environment, and convenient for copying parts of the record around locally.

This simple mechanism provides a basic protection against certain kinds of information theft or hacking if used properly. In the most secure situation, a hacker has to steal not just EHR data but also separate demographic records and an identity cross reference database, both of which can be located on different machines (making burglary harder). The identity cross-reference database would be easy to encrypt or protect by other security mechanisms.

h2. 7.4 Access Control

**Overview**
Access control is completely specified in an openEHR EHR in the @EHR_ACCESS@ object for the EHR. This object acts as a gateway for all information access, and any access decision must be made based on the policies and rules it contains. One of the problems with defining the semantics of the EHR Access object is that there is currently no published formal, proven model of access control for shared health information. Various efforts underway include the CEN EN13606 part 4 work, the ISO PMAC (Privilege Management and Access Control) work being done in TC/215 based on the generic security standard ISO/IEC 17799. Undoubtedly experimental and even some limited production health information security implementations exist. In reality however, no large-scale shared EHR deployments exist, and so security solutions to date are still developmental.
The openEHR architecture is therefore designed to accommodate alternative models of access control, each defined by a subtype of the class @ACCESS_CONTROL_SETTING@ (Security IM). This approach means that a simplistic access control model can be defined and implemented initially, with more sophisticated models being used later. The "scheme" in use at any given time is always indicated in the EHR Access object.

